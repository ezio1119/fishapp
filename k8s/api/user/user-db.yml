apiVersion: mysql.presslabs.org/v1alpha1
kind: MysqlCluster
metadata:
  name: user-db
spec:
  replicas: 1
  secretName: user-db-secret
  podSpec:
    resources:
      requests:
        cpu: 30m
        memory: 300Mi

  volumeSpec:
    persistentVolumeClaim:
      accessModes: ["ReadWriteOnce"]
      resources:
        requests:
          storage: 1Gi
  mysqlConf:
    character-set-server: utf8mb4
    collation-server: utf8mb4_unicode_ci
---
apiVersion: sql.cnrm.cloud.google.com/v1beta1
kind: SQLInstance
metadata:
  name: user-db
spec:
  databaseVersion: MYSQL_5_7
  region: asia-northeast1
  settings:
    tier: db-f1-micro
    # databaseFlags:
    # - name: character_set_server
    #   value: utf8mb4
  rootPassword:
    valueFrom:
      secretKeyRef:
        name: user-db-secret
        key: ROOT_PASSWORD
# ---
# apiVersion: sql.cnrm.cloud.google.com/v1beta1
# kind: SQLDatabase
# metadata:
#   name: user_DB
# spec:
#   charset: utf8mb4
#   collation: utf8mb4_unicode_ci
#   instanceRef:
#     name: user-db